

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Detection &mdash; SADIT 1.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="SADIT 1.1.0 documentation" href="index.html" />
    <link rel="next" title="Download" href="install.html" />
    <link rel="prev" title="Data Generation" href="configure.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="install.html" title="Download"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configure.html" title="Data Generation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SADIT 1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="detection">
<h1>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h1>
<div class="section" id="collection-of-anomaly-detection-algorithm">
<h2>Collection of Anomaly Detection Algorithm<a class="headerlink" href="#collection-of-anomaly-detection-algorithm" title="Permalink to this headline">¶</a></h2>
<p>It provides a collection of Internet Anomaly Detection algorithms proposed by
several researchers. Now it contains:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Stochastic Anomaly Detector using Large Deviation Theory</li>
<li>Deterministic Temporal Anomaly Detector using Support Vector Machine</li>
<li>Deterministic Flow by Flow Detector using Support Vector Machine</li>
<li>Anomaly Detection Techniques using ART theory</li>
</ol>
</div></blockquote>
<p>SADIT is not limited to the four algorithms listed above, its utimate goal is to
become a standard collection of a variety of internet anomaly detection
algorithms.</p>
<p>All the detection algorithms locates in the <em>ROOT/Detector</em> folder:</p>
<blockquote>
<div><ul class="simple">
<li><strong>SVMDetector.py</strong> contains two SVM based anomaly detection algorithmes
1. SVM Temporal Detector and 2. SVM Flow by Flow Detector.</li>
<li><strong>StoDetector.py</strong> contains two anomaly detection algorithms based on
Large Deviation Theory.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="parameters-for-detectors">
<h2>Parameters for Detectors<a class="headerlink" href="#parameters-for-detectors" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DETECTOR_DESC</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">interval</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">win_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">win_type</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="c"># &#39;time&#39;|&#39;flow&#39;</span>
        <span class="n">fr_win_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c"># window size for estimation of flow rate</span>
        <span class="n">false_alarm_rate</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="n">unified_nominal_pdf</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="c"># used in sensitivities analysis</span>
        <span class="n">fea_option</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;dist_to_center&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;flow_size&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;cluster&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span>
        <span class="n">ano_ana_data_file</span> <span class="o">=</span> <span class="n">ANO_ANA_DATA_FILE</span><span class="p">,</span>
        <span class="n">normal_rg</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="c"># range for normal traffic, if it none, use the</span>
        <span class="n">whole</span> <span class="n">traffic</span>
        <span class="n">detector_type</span> <span class="o">=</span> <span class="s">&#39;mfmb&#39;</span><span class="p">,</span> <span class="c"># can be anyone specfied by **detector_map** in *Detector/API.py*</span>
        <span class="n">max_detect_num</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="c"># the maximum detection number the detector will run</span>
        <span class="n">data_handler</span> <span class="o">=</span> <span class="s">&#39;fs&#39;</span><span class="p">,</span> <span class="c"># specify the data handler, can be any value defined in</span>
        <span class="n">data_handler_map</span> <span class="ow">in</span> <span class="n">Detector</span><span class="o">/</span><span class="n">API</span><span class="o">.</span><span class="n">py</span>

        <span class="c">#### only for SVM approach #####</span>
        <span class="c"># gamma = 0.01,</span>
        <span class="p">)</span>
</pre></div>
</div>
<div class="section" id="want-to-implement-your-algorithm">
<h3>Want to implement your algorithm?<a class="headerlink" href="#want-to-implement-your-algorithm" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="use-the-labeled-flow-records-generator-in-fs-simulator">
<h2>Use the labeled flow records generator in fs simulator<a class="headerlink" href="#use-the-labeled-flow-records-generator-in-fs-simulator" title="Permalink to this headline">¶</a></h2>
<p>The generated flows will be the <em>ROOT/Simulator</em> folder. The flows end with
<em>_flow.txt</em>, for example, n0_flow.txt is the network flows trough node 0. File
start with <em>abnormal_</em> is the exported abnormal flows correspondingly.</p>
<dl class="docutils">
<dt><strong>A typical line is</strong></dt>
<dd>textexport n0 1348412129.925416 1348412129.925416 1348412130.070733 10.0.7.4:80-&gt;10.0.8.5:53701 tcp 0x0 n1 5 4215 FSA</dd>
<dt><strong>line format</strong></dt>
<dd>prefix nodename time flow_start_time flow_end_time src_ip:src_port-&gt;dst_ip:dst_port protocol payload destname unknown flowsize unknown</dd>
</dl>
<p>After finishing your detection algorihms, the last thing you need to do is to
add the corresponding class name to <strong>detector_map</strong> in <em>ROOT/Detector/API.py</em>.
After that you will be able to use your detection algorithm. You can use
<strong>Compare</strong> experiment to compare with other algorithm or <strong>Eval</strong> algorithm to
Evaluate your algorithm. You can also implement new experiment to play with your
new algorithm.</p>
</div>
<div class="section" id="use-other-flow-records">
<h2>Use Other flow records<a class="headerlink" href="#use-other-flow-records" title="Permalink to this headline">¶</a></h2>
<p>SADIT does not only support the text output format of fs simulator, but also
several other types of flow data. The handler classes locate in the
<em>DataHandler.py</em> and <em>DataHandler_xflow.py</em>
<strong>DataFile</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>PreloadHardDistFile</strong> hard disk flow file generated by fs-simulator. It
will preload all the flow file into memory, so it cannot deal with flow
file larger than your memery</li>
<li><strong>PreloadHardDistFile_pcap2netflow</strong> hard disk flow file generated by
<a class="reference external" href="https://bitbucket.org/hbhzwj/pcap2netflow/src">pcap2netflow</a> tool(the
format of <a class="reference external" href="http://www.mindrot.org/projects/softflowd/">flowd-reader</a>)</li>
<li><strong>PreloadHardDistFile_xflow</strong>, hard disk flow file generated by xflow tool</li>
<li><strong>SQLFile_SperottoIPOM2009</strong>, labeled data stored in mysql server provided
by <a class="reference external" href="http://traces.simpleweb.org/traces/netflow/netflow2/">simpleweb.org</a></li>
</ul>
</div></blockquote>
<p>The following class is the abstract base class for all data files</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Data</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;virtual base class for data. Data class deals with any implementation</span>
<span class="sd">    details of the data. it can be a file, a sql data base, and so on, as long</span>
<span class="sd">    as it support the pure virtual methods defined here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_fea_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rg_type</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get a slice of feature</span>
<span class="sd">        - **rg** is the range for the slice</span>
<span class="sd">        - **rg_type** is the type for range, it can be [&#39;flow&#39;|&#39;time&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">abstract_method</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fea</span><span class="p">,</span> <span class="n">rg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rg_type</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get the max value of feature during a range</span>
<span class="sd">        - **fea** is a list of feature name</span>
<span class="sd">        - **rg** is the range</span>
<span class="sd">        - **rg_type** is the range type</span>
<span class="sd">        the output is the a list of element which contains the max</span>
<span class="sd">        value of the feature in **fea**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">abstract_method</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fea</span><span class="p">,</span> <span class="n">rg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rg_time</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get min value of feature within a range. see **get_max** for</span>
<span class="sd">        the meaning of the parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">abstract_method</span><span class="p">()</span>
</pre></div>
</div>
<p>It defines the operation we can do with data files. The four
algorithmes we implemented requires <strong>get_fea_slice</strong>, <strong>get_max</strong> and
<strong>get_min</strong> operations. You can implement more operations, but at least
implement these three operations.</p>
<p>Optionally, you can implement a handler class that will manipulate the
DataFile and and some useful quantities that may be useful to you algorithms.
For example, we implemented <strong>HardDiskFileHandler</strong> with get_em() function to
get probability distribution of the flows, which is useful for the stochastic
approaches. If you just need the raw data, you can define simple handler class
with data file object you want to use as member variable.</p>
<p>Then you just need to add your data_handler to <strong>data_handler_handle_map</strong>
defined in <em>ROOT/Detector/API.py</em></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Detection</a><ul>
<li><a class="reference internal" href="#collection-of-anomaly-detection-algorithm">Collection of Anomaly Detection Algorithm</a></li>
<li><a class="reference internal" href="#parameters-for-detectors">Parameters for Detectors</a><ul>
<li><a class="reference internal" href="#want-to-implement-your-algorithm">Want to implement your algorithm?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-the-labeled-flow-records-generator-in-fs-simulator">Use the labeled flow records generator in fs simulator</a></li>
<li><a class="reference internal" href="#use-other-flow-records">Use Other flow records</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configure.html"
                        title="previous chapter">Data Generation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="install.html"
                        title="next chapter">Download</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/detect.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="install.html" title="Download"
             >next</a> |</li>
        <li class="right" >
          <a href="configure.html" title="Data Generation"
             >previous</a> |</li>
        <li><a href="index.html">SADIT 1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jing Conan Wang.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>